{{- if and .Values.alerts.alertmanagerConfig.slack.webhookURL .Values.alerts.alertmanagerConfig.slack.channel }}
apiVersion: v1
kind: Secret
type: Opaque

metadata:
  name: {{ $.Release.Name }}-slack-webhook
  labels:
{{- include "kube-prometheus-stack.labels" . | indent 4 }}
data:
  slack-webhook-url: {{ required ".Values.alerts.alertmanagerConfig.slack.webhookURL undefined" .Values.alerts.alertmanagerConfig.slack.webhookURL | b64enc | quote }} 
{{- end }}
