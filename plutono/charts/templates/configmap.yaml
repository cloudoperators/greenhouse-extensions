apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ template "plutono.fullname" . }}
  namespace: {{ template "plutono.namespace" . }}
  labels:
    {{- include "plutono.labels" . | nindent 4 }}
{{- with .Values.plutono.annotations }}
  annotations:
{{ toYaml . | indent 4 }}
{{- end }}
data:
  plutono.ini: |
{{- range $key, $value := index .Values.plutono "plutono.ini" }}
    [{{ $key }}]
    {{- range $elem, $elemVal := $value }}
    {{- if kindIs "invalid" $elemVal }}
    {{ $elem }} =
    {{- else if kindIs "string" $elemVal }}
    {{ $elem }} = {{ tpl $elemVal $ }}
    {{- else }}
    {{ $elem }} = {{ $elemVal }}
    {{- end }}
    {{- end }}
{{- end }}
